
$(document).ready(function(){$(function(){$('[data-toggle="tooltip"]').tooltip()}),$("#loginForm .userlogin,#loginForm .passwordlogin,#loginForm .remember").keypress(function(o){13==o.which&&$(".btnlogin").trigger("click")}),$("#resetpassForm .userlogin,#resetpassForm .captcha").keypress(function(o){13==o.which&&$(".btnrspass").trigger("click")}),$("#formRegister .fullname,#formRegister .email,#formRegister .password,#formRegister .repassword,#formRegister .userphone").keypress(function(o){13==o.which&&$(".btnRegister").trigger("click")}),$("#loginButton").on("click",function(){bootbox&&bootbox.hideAll(),bootbox.dialog({title:"<b>Đăng Nhập</b>",message:$("#loginForm"),show:!1}).on("shown.bs.modal",function(){$("#loginForm").show()}).on("hide.bs.modal",function(){$("#loginForm").hide().appendTo("body")}).modal("show")}),$("#loginRegister").on("click",function(){bootbox&&bootbox.hideAll(),bootbox.dialog({title:"<b>Đăng ký thành viên</b>",message:$("#formRegister"),show:!1}).on("shown.bs.modal",function(){$("#formRegister").show()}).on("hide.bs.modal",function(){$("#formRegister").hide().appendTo("body")}).modal("show")}),$("#loginForm .reset-password").on("click",function(){Captcha(),$("#loginForm").hide().appendTo("body"),bootbox&&bootbox.hideAll(),bootbox.dialog({title:"<b>Lấy lại mật khẩu</b>",message:$("#resetpassForm"),show:!1}).on("shown.bs.modal",function(){$("#resetpassForm").show()}).on("hide.bs.modal",function(){$("#resetpassForm").hide().appendTo("body")}).modal("show")}),$("#loginForm .btnlogin").click(function(){$(".error-login-password").hide(),$(".error-login-email").hide(),$(".error-login").hide();var o=$("#loginForm .userlogin").val(),r=$("#loginForm .passwordlogin").val(),e=$("#loginForm .remember").is(":checked");""==o&&$(".error-login-email").show(),""==r&&$(".error-login-password").show(),o&&r&&$.ajax({type:"POST",url:loginURL,dataType:"json",data:{strUsername:o,strPassWord:r,remember:e},success:function(o){1==o.st?window.parent.location=window.parent.location:($("#loginForm .error-login").show(),$("#loginForm .error-login").html('<b style="color:red">'+o.ms+"</b>"))}})}),$("#resetpassForm .btnrspass").click(function(){$(".error-forgot").hide(),$(".error-forgot-email").hide(),$(".error-forgot-captcha").hide();var o=$("#resetpassForm .userlogin").val(),r=$("#resetpassForm .captcha").val();""==o&&$(".error-forgot-email").show(),""==r&&$(".error-forgot-captcha").show(),o&&r&&$.ajax({type:"POST",url:resetpassURL,dataType:"json",data:{user_email:o,captcha:r},success:function(o){1==o.st?(bootbox&&bootbox.hideAll(),bootbox.alert(o.ms,function(){})):($("#resetpassForm .error-forgot").show(),$("#resetpassForm .error-forgot").html('<b style="color:red">'+o.ms+"</b>"))}})}),$("#formRegister .btnRegister").click(function(){$(".error-register-fullname").hide(),$(".error-register-email").hide(),$(".error-register-password").hide(),$(".error-register-repassword").hide(),$(".error-register-phone").hide(),$(".error-register-fullname").hide(),$(".error-register-fullname").hide(),$(".error-register").hide();var o=$("#formRegister .fullname").val(),r=$("#formRegister .email").val(),e=$("#formRegister .password").val(),s=$("#formRegister .repassword").val(),t=$("#formRegister .userphone").val(),i=0;o.length<4&&($(".error-register-fullname").show(),i+=1),e.length<6&&($(".error-register-password").show(),i+=1),""!=e&&s!=e&&($(".error-register-repassword").show(),i+=1),IsEmail(r)||($(".error-register-email").show(),i+=1),validatePhone(t)||($(".error-register-phone").show(),i+=1),0==i&&$.ajax({type:"POST",url:registerURL,dataType:"json",data:{user_fullname:o,user_password:e,re_user_password:s,user_email:r,user_phone:t},success:function(o){1==o.st?(bootbox&&bootbox.hideAll(),bootbox.alert(o.ms,function(){window.parent.location=window.parent.location})):($(".error-register").show(),$(".error-register").html('<b style="color:red">'+o.ms+"</b>"))}})}),Captcha=function(){$.ajax({type:"POST",url:captchaURL,dataType:"json",success:function(o){$(".img-captcha").attr("src",o.url)}})},IsEmail=function(o){var r=/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;return r.test(o)},validatePhone=function(o){var r=/^[0-9-+]+$/;return r.test(o)?!(o.length<8||o.length>12):!1},$("#resetpassForm .fa-refresh").click(function(){Captcha()})});